Tuyá»‡t vá»i! DÆ°á»›i Ä‘Ã¢y lÃ  file shell script (`refactor_revm_structure.sh`) Ä‘á»ƒ **move vÃ  rename** cÃ¡c file theo kiáº¿n trÃºc má»›i, cÃ¹ng vá»›i **TODO checklist** cho tá»«ng pháº§n Ä‘á»ƒ báº¡n fix ná»™i dung code sau khi tá»• chá»©c láº¡i.

---

## ðŸ–¥ï¸ `refactor_revm_structure.sh`

```bash
#!/bin/bash

mkdir -p src/bin
mkdir -p src/core
mkdir -p src/config
mkdir -p src/source
mkdir -p src/chain
mkdir -p src/bytecode

# Move CLI entrypoint
mv src/bin/eth_call_one.rs src/bin/simulate.rs

# Core logic
mv src/bin/eth_call.rs          src/core/call.rs
mv src/bin/eth_revm.rs          src/core/revm.rs
mv src/bin/eth_revm_cached.rs   src/core/revm_cached.rs
mv src/bin/eth_revm_quoter.rs   src/core/revm_quoter.rs
mv src/bin/eth_validate.rs      src/core/validate.rs
mv src/bin/eth_arbitrage.rs     src/core/arbitrage.rs
mv src/bin/eth_anvil.rs         src/core/anvil.rs

# Move AVAX logic if needed
mv src/bin/avax_call.rs         src/core/avax_call.rs
mv src/bin/ronin_call.rs        src/core/ronin_call.rs

# Chain config
mv src/chain/*.rs               src/chain/
mv src/chain/mod.rs             src/chain/mod.rs

# Source ABI + helpers
mv src/source/abi.rs            src/source/abi.rs
mv src/source/helpers.rs        src/source/builder.rs

# Bytecode
mv src/bytecode/generic_erc20.hex src/bytecode/
mv src/bytecode/uni_v3_quoter.hex src/bytecode/

# Contracts (optional move to test folder or leave)
mkdir -p src/contracts
mv src/contracts/uni_v3_quoter.sol src/contracts/

# Update lib
echo "pub mod core;" >> src/lib.rs
echo "pub mod config;" >> src/lib.rs
```

> ðŸ” **Run file:**

```bash
chmod +x refactor_revm_structure.sh
./refactor_revm_structure.sh
```

---

## ðŸ“‹ Checklist chá»‰nh sá»­a ná»™i dung file sau khi move

### âœ… `src/bin/simulate.rs`

* [ ] Äá»•i thÃ nh CLI entrypoint vá»›i `clap`
* [ ] Load `--chain`, `--method`, `--volume`, `--from_token`, `--to_token`
* [ ] Gá»i tÆ°Æ¡ng á»©ng: `core::call::run(...)` hoáº·c `core::revm::run(...)`

---

### âœ… `src/core/*`

| File             | Viá»‡c cáº§n lÃ m                                                                   |
| ---------------- | ------------------------------------------------------------------------------ |
| `call.rs`        | Gá»™p logic tá»« `eth_call.rs`, `avax_call.rs`, `ronin_call.rs` dÃ¹ng `ChainConfig` |
| `revm.rs`        | Gom `eth_revm.rs`, chuyá»ƒn cÃ¡c address sang tá»« `ChainTokens`                    |
| `revm_cached.rs` | TÃ¡ch thÃ nh hÃ m riÃªng náº¿u cáº§n giá»¯                                               |
| `revm_quoter.rs` | Gom láº¡i REVM + CustomQuoter logic                                              |
| `anvil.rs`       | Äá»•i `spawn_anvil()` thÃ nh hÃ m reusable                                         |
| `validate.rs`    | DÃ¹ng cáº£ `eth_call` vÃ  `revm_revert` Ä‘á»ƒ so sÃ¡nh                                 |
| `arbitrage.rs`   | Loop logic ETH â†’ USDC â†’ ETH, tÃ­nh profit                                       |

---

### âœ… `src/config/*.toml`

* [ ] Táº¡o `eth.toml`, `avax.toml`, `ronin.toml` chá»©a RPC, chain\_id, quoter, token

---

### âœ… `src/chain/*.rs`

* [ ] Biáº¿n `WETH_ADDR` thÃ nh `ChainTokens` struct
* [ ] TÃ¡ch cÃ¡c Ä‘á»‹a chá»‰ router/pool ra khá»i logic gá»‘c
* [ ] DÃ¹ng `pub fn get_tokens() -> ChainTokens`

---

### âœ… `src/source/abi.rs`, `builder.rs`

* [ ] Giá»¯ nguyÃªn chá»©c nÄƒng ABI encode/decode
* [ ] TÃ¡ch `build_tx*` sang `builder.rs`

---

### âœ… `types.rs`

* [ ] Táº¡o cÃ¡c struct: `ChainConfig`, `ChainTokens`, `SimResult`, ...

---

## âœ… Tá»•ng káº¿t

Báº¡n chá»‰ cáº§n:

1. Cháº¡y shell script Ä‘á»ƒ move/rename files
2. Fix ná»™i dung cÃ¡c file theo checklist tá»«ng pháº§n á»Ÿ trÃªn
3. MÃ¬nh cÃ³ thá»ƒ:

   * Viáº¿t CLI entrypoint máº«u `simulate.rs`
   * Viáº¿t `types.rs` máº«u vá»›i `ChainConfig`, `ChainTokens`
   * Táº¡o `eth.toml` cáº¥u hÃ¬nh máº«u

ðŸ‘‰ Báº¡n muá»‘n mÃ¬nh báº¯t Ä‘áº§u tá»« pháº§n nÃ o?
